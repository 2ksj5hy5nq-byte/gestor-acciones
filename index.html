<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Gestor de Acciones</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: white;
  padding: 15px;
}
input, select, button {
  width: 100%;
  padding: 8px;
  margin: 6px 0;
}
button {
  background: #2563eb;
  color: white;
  border: none;
  border-radius: 6px;
}
button.danger {
  background: #c0392b;
}
button.edit {
  background: #f59e0b;
  margin-bottom: 4px;
}
table {
  width: 100%;
  margin-top: 15px;
  border-collapse: collapse;
}
th, td {
  border-bottom: 1px solid #334155;
  padding: 6px;
  text-align: center;
  font-size: 14px;
}
.total {
  font-size: 18px;
  margin-top: 10px;
}
</style>
</head>

<body>

<h2>üìà Gestor de Acciones</h2>

<input id="accion" placeholder="Acci√≥n (ej. AAPL)">
<select id="tipo">
  <option value="COMPRA">Compra</option>
  <option value="VENTA">Venta</option>
</select>
<input id="cantidad" type="number" placeholder="Cantidad">
<input id="precio" type="number" step="0.01" placeholder="Precio">

<button onclick="guardar()">Guardar operaci√≥n</button>
<button class="danger" onclick="borrarTodo()">üóë Borrar todo</button>

<div class="total" id="resultado">Total: 0 ‚Ç¨</div>

<table>
<thead>
<tr>
  <th>Acci√≥n</th>
  <th>Tipo</th>
  <th>Cant.</th>
  <th>Precio</th>
  <th>Total</th>
  <th>Editar</th>
</tr>
</thead>
<tbody id="tabla"></tbody>
</table>

<script>
let ops = JSON.parse(localStorage.getItem("ops")) || [];
let editIndex = null;

function guardar() {
  const accion = document.getElementById("accion").value;
  const tipo = document.getElementById("tipo").value;
  const cantidad = Number(document.getElementById("cantidad").value);
  const precio = Number(document.getElementById("precio").value);

  if (!accion || !cantidad || !precio) {
    alert("Completa todos los campos");
    return;
  }

  const signo = tipo === "VENTA" ? -1 : 1;
  const total = cantidad * precio * signo;

  const data = { accion, tipo, cantidad, precio, total };

  if (editIndex !== null) {
    ops[editIndex] = data;
    editIndex = null;
  } else {
    ops.push(data);
  }

  localStorage.setItem("ops", JSON.stringify(ops));
  limpiar();
  render();
}

function editar(i) {
  const o = ops[i];
  document.getElementById("accion").value = o.accion;
  document.getElementById("tipo").value = o.tipo;
  document.getElementById("cantidad").value = o.cantidad;
  document.getElementById("precio").value = o.precio;
  editIndex = i;
}

function borrarTodo() {
  if (!confirm("¬øSeguro que quieres borrar todo?")) return;
  localStorage.removeItem("ops");
  ops = [];
  editIndex = null;
  render();
}

function limpiar() {
  document.getElementById("accion").value = "";
  document.getElementById("cantidad").value = "";
  document.getElementById("precio").value = "";
}

function render() {
  const tabla = document.getElementById("tabla");
  tabla.innerHTML = "";
  let suma = 0;

  ops.forEach((o, i) => {
    suma += o.total;
    tabla.innerHTML += `
      <tr>
        <td>${o.accion}</td>
        <td>${o.tipo}</td>
        <td>${o.cantidad}</td>
        <td>${o.precio}</td>
        <td>${o.total.toFixed(2)} ‚Ç¨</td>
        <td>
          <button class="edit" onclick="editar(${i})">‚úèÔ∏è</button>
        </td>
      </tr>
    `;
  });

  document.getElementById("resultado").textContent =
    "Total: " + suma.toFixed(2) + " ‚Ç¨";
}

render();
</script>

</body>
</html>
