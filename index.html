async function cargarAcciones() {
  const contenedor = document.getElementById("listaAcciones");
  contenedor.innerHTML = "";

  const q = query(
    collection(db, "acciones"),
    where("uid", "==", user.uid),
    orderBy("fecha", "desc")
  );

  const snapshot = await getDocs(q);

  const accionesPorNombre = {};

  snapshot.forEach(doc => {
    const a = doc.data();
    const nombre = a.nombre || "Sin nombre";

    if (!accionesPorNombre[nombre]) {
      accionesPorNombre[nombre] = [];
    }

    accionesPorNombre[nombre].push(a);
  });

  for (const nombre in accionesPorNombre) {
    const h4 = document.createElement("h4");
    h4.textContent = nombre;
    contenedor.appendChild(h4);

    const ul = document.createElement("ul");

    accionesPorNombre[nombre].forEach(a => {
      const li = document.createElement("li");

      const fecha = a.fecha
        ? a.fecha.split("-").reverse().join("/")
        : "sin fecha";

      li.textContent = `${fecha} — ${a.tipo} — ${a.importe} €`;
      ul.appendChild(li);
    });

    contenedor.appendChild(ul);
  }
}
