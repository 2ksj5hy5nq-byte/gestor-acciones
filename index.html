<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Gestor de Acciones</title>
<style>
body{font-family:Arial;background:#0f172a;color:white;padding:15px}
input,select,button{padding:6px;margin:4px}
button{font-weight:bold}
.bloque{
  border:1px solid #334155;
  border-radius:8px;
  padding:10px;
  margin-top:12px;
}
.ganancia{color:#22c55e;font-weight:bold}
.perdida{color:#ef4444;font-weight:bold}
</style>
</head>

<body>
<h2>ðŸ“ˆ Gestor de Acciones</h2>

<input id="accion" placeholder="AcciÃ³n (ej: AAPL)">
<select id="tipo">
  <option value="compra">Compra</option>
  <option value="venta">Venta</option>
</select>
<input id="cantidad" type="number" placeholder="Cantidad">
<input id="precio" type="number" step="0.01" placeholder="Precio">
<input id="fecha" type="date">
<button onclick="guardar()">Guardar</button>

<hr>

<h3>ðŸ“¦ Operaciones cerradas</h3>
<div id="cerradas"></div>

<script>
let abiertas = JSON.parse(localStorage.getItem("abiertas")) || [];
let cerradas = JSON.parse(localStorage.getItem("cerradas")) || [];

function guardar(){
  const a = accion.value.toUpperCase();
  const t = tipo.value;
  const n = +cantidad.value;
  const p = +precio.value;
  const f = fecha.value;

  if(!a||!n||!p||!f) return alert("Completa todos los campos");

  if(t==="compra"){
    abiertas.push({a,n,p,f});
  }else{
    let i = abiertas.findIndex(o=>o.a===a && o.n===n);
    if(i===-1) return alert("No hay compra abierta para cerrar");

    let c = abiertas.splice(i,1)[0];
    let r = (p - c.p) * n;

    cerradas.push({
      a,
      n,
      compra:c.p,
      fechaCompra:c.f,
      venta:p,
      fechaVenta:f,
      resultado:r
    });
  }

  localStorage.setItem("abiertas",JSON.stringify(abiertas));
  localStorage.setItem("cerradas",JSON.stringify(cerradas));
  pintar();
}

function pintar(){
  const div = document.getElementById("cerradas");
  div.innerHTML="";
  cerradas.forEach(o=>{
    div.innerHTML+=`
    <div class="bloque">
      <strong>${o.a}</strong><br>
      Compra: ${o.n} Ã— ${o.compra} â‚¬ (${o.fechaCompra})<br>
      Venta: ${o.n} Ã— ${o.venta} â‚¬ (${o.fechaVenta})<br>
      Resultado:
      <span class="${o.resultado>=0?'ganancia':'perdida'}">
        ${o.resultado.toFixed(2)} â‚¬
      </span>
    </div>`;
  });
}
pintar();
</script>

</body>
</html>
