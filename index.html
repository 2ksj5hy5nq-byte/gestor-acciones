<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Gestor de Acciones</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: white;
  padding: 15px;
}
input, select, button {
  width: 100%;
  padding: 8px;
  margin: 6px 0;
}
button {
  background: #2563eb;
  color: white;
  border: none;
  border-radius: 6px;
}
button.edit { background: #f59e0b; }
button.delete { background: #c0392b; }
table {
  width: 100%;
  margin-top: 15px;
  border-collapse: collapse;
}
th, td {
  border-bottom: 1px solid #334155;
  padding: 6px;
  text-align: center;
  font-size: 14px;
}
.total {
  font-size: 18px;
  margin-top: 10px;
}
</style>
</head>

<body>

<h2>ğŸ“Š Gestor de Acciones</h2>

<input id="accion" placeholder="AcciÃ³n (ej. AAPL)">
<select id="tipo">
  <option value="COMPRA">Compra</option>
  <option value="VENTA">Venta</option>
</select>
<input id="cantidad" type="number" placeholder="Cantidad">
<input id="precio" type="number" step="0.01" placeholder="Precio">

<button onclick="guardar()">Guardar operaciÃ³n</button>

<div class="total" id="resultado">Total: 0 â‚¬</div>

<table>
<thead>
<tr>
  <th>AcciÃ³n</th>
  <th>Tipo</th>
  <th>Cant.</th>
  <th>Precio</th>
  <th>Total</th>
  <th>âœï¸</th>
  <th>ğŸ—‘</th>
</tr>
</thead>
<tbody id="tabla"></tbody>
</table>

<script>
let ops = JSON.parse(localStorage.getItem("ops")) || [];
let editIndex = null;

function guardar() {
  const accion = document.getElementById("accion").value.trim();
  const tipo = document.getElementById("tipo").value;
  const cantidad = Number(document.getElementById("cantidad").value);
  const precio = Number(document.getElementById("precio").value);

  if (!accion || !cantidad || !precio) {
    alert("Completa todos los campos");
    return;
  }

  const signo = tipo === "VENTA" ? -1 : 1;
  const total = cantidad * precio * signo;
  const data = { accion, tipo, cantidad, precio, total };

  // CONFIRMACIÃ“N AL EDITAR (sobrescribir)
  if (editIndex !== null) {
    const ok = confirm("Â¿Guardar cambios y sobrescribir esta operaciÃ³n?");
    if (!ok) return;
    ops[editIndex] = data;
    editIndex = null;
  } else {
    ops.push(data);
  }

  localStorage.setItem("ops", JSON.stringify(ops));
  limpiar();
  render();
}

function editar(i) {
  const o = ops[i];
  document.getElementById("accion").value = o.accion;
  document.getElementById("tipo").value = o.tipo;
  document.getElementById("cantidad").value = o.cantidad;
  document.getElementById("precio").value = o.precio;
  editIndex = i;
}

function borrarUno(i) {
  const ok = confirm("Â¿Seguro que quieres borrar esta operaciÃ³n?");
  if (!ok) return;
  ops.splice(i, 1);
  localStorage.setItem("ops", JSON.stringify(ops));
  render();
}

function limpiar() {
  document.getElementById("accion").value = "";
  document.getElementById("cantidad").value = "";
  document.getElementById("precio").value = "";
}

function render() {
  const tabla = document.getElementById("tabla");
  tabla.innerHTML = "";
  let suma = 0;

  ops.forEach((o, i) => {
    suma += o.total;
    tabla.innerHTML += `
      <tr>
        <td>${o.accion}</td>
        <td>${o.tipo}</td>
        <td>${o.cantidad}</td>
        <td>${o.precio}</td>
        <td>${o.total.toFixed(2)} â‚¬</td>
        <td><button class="edit" onclick="editar(${i})">âœï¸</button></td>
        <td><button class="delete" onclick="borrarUno(${i})">ğŸ—‘</button></td>
      </tr>
    `;
  });

  document.getElementById("resultado").textContent =
    "Total: " + suma.toFixed(2) + " â‚¬";
}

render();
</script>

</body>
</html>
